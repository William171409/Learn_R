---
title: "Q1"
author: "William HU ZIHAO"
date: "2024-09-24"
output: pdf_document
---

## Q1

### 1) Leap Year

```{r}
is_leap_year <- function(year) {
  if (!is.numeric(year) || year != as.integer(year)) {
    message("Invalid input: The year must be an integer or a numeric in integer format.")
  }
  else{
    ((year %% 4 == 0 && year %% 100 != 0) || (year %% 400 == 0))
  }

}
```

```{r}
is_leap_year(2012)
is_leap_year(2023)
is_leap_year(2024.000)
is_leap_year(2024.2910)
is_leap_year("2024")
```

### 2) Weekday of 28th

```{r}
weekdays_28th <- function(year) {
    if (!is.numeric(year) || year != as.integer(year)) {
    message("Invalid input: The year must be an integer or a numeric in integer format.")
  }
  else{
      months <- c(1:12)
      date_strs <- as.Date(paste0(year, "-", months, "-28"))
      weekdays <- sapply(date_strs, (\(x) {format(x, "%a")}))  
  
      for (month in months)
      {
       cat(paste0(year,"-",month,"-28 is ", weekdays[month]),"\n") 
      }
  }
}
```

```{r}
weekdays_28th(2024)
cat("\n")
weekdays_28th(2031.9009021)
cat("\n")
weekdays_28th("2024")
cat("\n")
weekdays_28th(1923)
cat("\n")
weekdays_28th(2923)
```

### 3) Working Days

```{r}
library(bizdays)

# Final function for counting working days
count_working_days <- function(year) {
  if (!is.numeric(year) || year != as.integer(year)) {
    message("Invalid input: The year must be an integer or a numeric in integer format.")
    return()
  } else {
    start_date <- as.Date(paste0(year, "-01-01"))
    end_date <- as.Date(paste0(year, "-12-31"))
    
    working_days <- 0
    current_date <- start_date
    
    while (current_date <= end_date) {
      weekday <- format(current_date, "%a")
      if (weekday != "Sat" && weekday != "Sun") {
        working_days <- working_days + 1
      }
      current_date <- current_date + 1
    }
    
    # Count working days using bizdays
    create.calendar("MyCalendar", holidays = NULL, weekdays = c("saturday", "sunday"), start.date = start_date, end.date = end_date + 3)
    
    working_days_bizdays <- bizdays(start_date, bizdays::adjust.next(end_date, "MyCalendar"), "MyCalendar")
    
    # If end_date is a weekday, add 1
    if (format(end_date, "%a") != "Sat" && format(end_date, "%a") != "Sun") {
      working_days_bizdays <- working_days_bizdays + 1
    }
    
    # Return both manual and bizdays results
    return(list(manual_count = working_days, bizdays_count = working_days_bizdays))
  }
}

```

```{r}
# TEST FUNCTION GENERATED BY ChatGPT

# Testing loop for a range of valid inputs (years)
test_years <- 1900:2900  # Range of years to test
discrepancies <- list()  # To store any discrepancies between manual and bizdays counts

for (year in test_years) {
  result <- count_working_days(year)
  
  if (result$manual_count != result$bizdays_count) {
    # If there is a discrepancy, store the year and the respective counts
    discrepancies[[as.character(year)]] <- result
    cat("Discrepancy found for year:", year, "\n")
  }
}

# Summary of results
if (length(discrepancies) == 0) {
  cat("All tests passed! No discrepancies found.\n")
} else {
  cat("Discrepancies found in the following years:\n")
  print(discrepancies)
}

```
